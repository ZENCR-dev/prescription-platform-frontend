# ğŸš¨ å‰ç«¯ç³»ç»ŸSupabase-Firstæ¶æ„é‡æ„PRDæŠ€æœ¯è¦ç´ æ–‡æ¡£

**æ–‡æ¡£æ€§è´¨**: å‰ç«¯Supabase-Firstæ¶æ„æŠ€æœ¯é‡æ„æŒ‡å¯¼æ–‡æ¡£  
**ç›®æ ‡ç”¨é€”**: ä¸ºæ–°é¡¹ç›®ç»„æä¾›å®Œæ•´çš„Supabaseä¼˜å…ˆæŠ€æœ¯æ¶æ„è®¾è®¡å‚è€ƒå’Œå®ç°è·¯å¾„æŒ‡å¯¼  
**æ¶æ„åŸåˆ™**: Supabase-Firstï¼Œå®Œå…¨æ›¿ä»£è‡ªå®šä¹‰è®¤è¯ï¼Œéšç§åˆè§„è®¾è®¡  
**é¢—ç²’åº¦æ§åˆ¶**: Supabaseé›†æˆè®¾è®¡å±‚é¢ç»†èŠ‚ä¿ç•™ï¼Œå…·ä½“å®ç°æ–¹å¼å¼€æ”¾ç»™é¡¹ç›®ç»„è§£å†³  
**ç»„ç»‡æ–¹å¼**: æŒ‰åŠŸèƒ½æ¨¡å—ç»„ç»‡ï¼Œç»“åˆSupabase-Firstæ¶æ„çš„7å‘¨MVPäº¤ä»˜é‡Œç¨‹ç¢‘ç­–ç•¥  

**ğŸš¨ é‡è¦å£°æ˜**: 
- å®Œå…¨é‡‡ç”¨**Supabase-Firstæ¶æ„åŸåˆ™**ï¼Œæ‰€æœ‰è‡ªå®šä¹‰è®¤è¯ä»£ç è¢«Supabase Authæ›¿ä»£
- APIæ¥å£è§„èŒƒã€æ•°æ®æ¨¡å‹ä¸€è‡´æ€§ã€å­—æ®µå‘½åç­‰ä»¥**åç«¯SupabaseæŠ€æœ¯è½¬ç§»æ–‡æ¡£ä¸ºå‡†**
- **éšç§åˆè§„å¼ºåˆ¶è¦æ±‚**ï¼šå®Œå…¨ç§»é™¤æ‚£è€…éšç§ä¿¡æ¯ï¼Œæ•°æ®æ¨¡å‹åŒ¿ååŒ–è®¾è®¡
- æœ¬æ–‡æ¡£é‡ç‚¹æä¾›Supabaseæ¶æ„é›†æˆé€»è¾‘å’ŒæŠ€æœ¯é€‰å‹ä¾æ®ï¼Œå…·ä½“å®ç°ç»†èŠ‚ç”±æ–°é¡¹ç›®ç»„ç ”ç©¶æ¨å¯¼

---

## ğŸ¯ Supabase-Firstæ¸è¿›å¼å¤ç°ç­–ç•¥ä¸MVPäº¤ä»˜æ¶æ„

### ğŸš¨ æ ¸å¿ƒæ¶æ„å˜æ›´é€šçŸ¥

åŸºäºå®‰å…¨è¯„ä¼°å’Œç°ä»£äº‘åŸç”Ÿæœ€ä½³å®è·µï¼Œé‡‡ç”¨**Supabase-Firstæ¶æ„åŸåˆ™**ï¼š

| æŠ€æœ¯é¢†åŸŸ | âŒ åŸæ–¹æ¡ˆ | âœ… æ–°æ–¹æ¡ˆ (å¼ºåˆ¶è¦æ±‚) | å˜æ›´åŸå›  |
|---------|----------|-------------|---------|
| **è®¤è¯ç³»ç»Ÿ** | è‡ªå®šä¹‰JWT + Passport.js | ğŸš¨ Supabase Auth (GoTrue) | 373è¡Œè‡ªå®šä¹‰ä»£ç å­˜åœ¨å®‰å…¨é£é™©ï¼Œ0%å¤ç”¨ç‡ |
| **æ•°æ®è®¿é—®** | Prisma ORM + è‡ªå®šä¹‰æƒé™ | ğŸš¨ Supabase Client + RLSç­–ç•¥ | æ•°æ®åº“å±‚æƒé™æ§åˆ¶ï¼Œæ›´é«˜å®‰å…¨æ€§ |
| **å®æ—¶é€šä¿¡** | WebSocketå¯é€‰ | ğŸš¨ Supabase Realtime | åŸç”Ÿæ•°æ®åº“å˜æ›´è®¢é˜…ï¼Œæ›´å¯é  |
| **æ–‡ä»¶å­˜å‚¨** | æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ | ğŸš¨ Supabase Storage | äº‘åŸç”Ÿå­˜å‚¨ï¼Œè‡ªåŠ¨CDNå’Œæƒé™æ§åˆ¶ |
| **æ•°æ®æ¨¡å‹** | åŒ…å«æ‚£è€…éšç§ä¿¡æ¯ | ğŸš¨ å®Œå…¨åŒ¿ååŒ–å¤„æ–¹ | GDPR/HIPAAåˆè§„è¦æ±‚ |

### Supabase-First MVPäº¤ä»˜é‡Œç¨‹ç¢‘

åŸºäºSupabaseä¼˜å…ˆæ¶æ„ï¼Œé‡‡ç”¨7é˜¶æ®µMVPäº¤ä»˜æ¨¡å¼ï¼Œç¡®ä¿æ¯ä¸ªé˜¶æ®µéƒ½æœ‰å¯éªŒè¯çš„Supabaseé›†æˆäº¤ä»˜ç‰©ï¼š

#### **MVP 0.1 - Supabaseç¯å¢ƒæ­å»º** (Week 1)
- **Supabaseé¡¹ç›®åˆ›å»º**ï¼šå¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ä¸‰ä¸ªç¯å¢ƒ
- **Supabase CLIé…ç½®**ï¼šæœ¬åœ°å¼€å‘ç¯å¢ƒå’Œç±»å‹ç”Ÿæˆ
- **åŸºç¡€è®¤è¯é›†æˆ**ï¼šSupabase AuthåŸºç¡€é…ç½®
- **RLSç­–ç•¥ç†è§£**ï¼šæ•°æ®åº“å±‚æƒé™æ§åˆ¶å­¦ä¹ 
- **äº¤ä»˜æ ‡å‡†**: Supabaseé¡¹ç›®å¯è¿æ¥ï¼ŒAuthè®¤è¯æµç¨‹å¯ç”¨

#### **MVP 0.2 - Supabase Authé›†æˆ** (Week 2)  
- **ğŸš¨ å®Œå…¨æ›¿ä»£JWTè®¤è¯**ï¼šç§»é™¤æ‰€æœ‰è‡ªå®šä¹‰è®¤è¯ä»£ç 
- **RLSç­–ç•¥å®ç°**ï¼šåŒ»å¸ˆæ•°æ®éš”ç¦»ã€è¯æˆ¿æƒé™æ§åˆ¶
- **ç±»å‹å®‰å…¨é›†æˆ**ï¼š`supabase gen types typescript`è‡ªåŠ¨ç”Ÿæˆ
- **å®æ—¶ä¼šè¯ç®¡ç†**ï¼šSupabase AuthçŠ¶æ€è®¢é˜…
- **äº¤ä»˜æ ‡å‡†**: Supabase Authå®Œå…¨é›†æˆï¼ŒRLSç­–ç•¥ç”Ÿæ•ˆ

#### **MVP 0.3 - æ•°æ®æ¨¡å‹é€‚é…** (Week 3-4)
- **ğŸš¨ éšç§åˆè§„æ•°æ®æ¨¡å‹**ï¼šå®Œå…¨ç§»é™¤æ‚£è€…éšç§ä¿¡æ¯
- **åŒ¿ååŒ–å¤„æ–¹è®¾è®¡**ï¼šprescriptionCodeæ›¿ä»£æ‚£è€…ä¿¡æ¯
- **Supabaseè¡¨ç»“æ„**ï¼šå¯¹æ¥åç«¯10å¼ æ ¸å¿ƒä¸šåŠ¡è¡¨
- **å®æ—¶æ•°æ®è®¢é˜…**ï¼šSupabase Realtimeé›†æˆ
- **äº¤ä»˜æ ‡å‡†**: éšç§åˆè§„çš„åŒ¿åå¤„æ–¹æµç¨‹ï¼Œå®æ—¶æ•°æ®åŒæ­¥

#### **MVP 0.4 - Edge Functionsé›†æˆ** (Week 5)
- **æœåŠ¡å™¨ç«¯è®¡ç®—**ï¼šä»·æ ¼è®¡ç®—è¿ç§»åˆ°Edge Functions
- **Stripeé›†æˆä¼˜åŒ–**ï¼šæ”¯ä»˜æµç¨‹Edge Functionså¤„ç†
- **æ–‡ä»¶ä¸Šä¼ é›†æˆ**ï¼šSupabase Storageæ–‡ä»¶ç®¡ç†
- **æ€§èƒ½ä¼˜åŒ–**ï¼šRLSç­–ç•¥æŸ¥è¯¢ä¼˜åŒ–
- **äº¤ä»˜æ ‡å‡†**: Edge Functionsä¸šåŠ¡é€»è¾‘å°±ç»ªï¼ŒSupabase Storageå¯ç”¨

#### **MVP 0.5 - Supabase Realtimeå®Œæ•´é›†æˆ** (Week 6)
- **å®æ—¶æ•°æ®åŒæ­¥**ï¼šå¤„æ–¹çŠ¶æ€ã€è´¦æˆ·ä½™é¢å®æ—¶æ›´æ–°
- **è®¢é˜…ç®¡ç†ä¼˜åŒ–**ï¼šé«˜æ•ˆçš„æ•°æ®åº“è®¢é˜…ç­–ç•¥
- **ç¦»çº¿æ•°æ®åŒæ­¥**ï¼šä¸Supabaseçš„å¢é‡åŒæ­¥æœºåˆ¶
- **ç›‘æ§é›†æˆ**ï¼šSupabase Analyticså’Œé”™è¯¯ç›‘æ§
- **äº¤ä»˜æ ‡å‡†**: å®Œæ•´å®æ—¶åŠŸèƒ½ï¼Œç¦»çº¿åŒæ­¥å¯ç”¨

#### **MVP 1.0 - Vercelç”Ÿäº§éƒ¨ç½²** (Week 7)
- **Vercel + Supabaseé›†æˆ**ï¼šç”Ÿäº§ç¯å¢ƒé…ç½®
- **ç¯å¢ƒå˜é‡é…ç½®**ï¼šSupabaseç”Ÿäº§ç¯å¢ƒå¯†é’¥
- **ç›‘æ§å‘Šè­¦é…ç½®**ï¼šSupabase Dashboardç›‘æ§
- **å®Œæ•´ç³»ç»Ÿæµ‹è¯•**ï¼šç«¯åˆ°ç«¯Supabaseé›†æˆéªŒè¯
- **äº¤ä»˜æ ‡å‡†**: ç”Ÿäº§å°±ç»ªçš„Supabase-Firstç³»ç»Ÿ

**âš ï¸ æ—¶é—´çº¿åè°ƒ**: ä¸åç«¯Supabase-First 7å‘¨å¼€å‘è®¡åˆ’å¯¹é½ï¼Œç¡®ä¿RLSç­–ç•¥åŒæ­¥ï¼ŒEdge Functionsè”è°ƒ

### Supabase-Firstå¼€å‘ç­–ç•¥

#### **é˜¶æ®µ1: Supabaseç‹¬ç«‹å¼€å‘** (Week 1-5)
- åŸºäºSupabase Authè®¤è¯å’ŒRLSç­–ç•¥
- ä½¿ç”¨Supabaseæµ‹è¯•ç¯å¢ƒå’Œç§å­æ•°æ®
- å®Œæ•´çš„åŒ¿ååŒ–å¤„æ–¹ä½“éªŒ
- Supabase Clientç›´æ¥æ•°æ®åº“è®¿é—®

#### **é˜¶æ®µ2: Edge Functionsé›†æˆ** (Week 5-6)
- å¤æ‚ä¸šåŠ¡é€»è¾‘è¿ç§»åˆ°Supabase Edge Functions
- Stripeæ”¯ä»˜Edge Functionså¤„ç†
- ä»·æ ¼è®¡ç®—æœåŠ¡å™¨ç«¯æ‰§è¡Œ
- Supabase Storageæ–‡ä»¶ç®¡ç†

#### **é˜¶æ®µ3: ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–** (Week 7)
- Vercel + Supabaseç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
- RLSç­–ç•¥æ€§èƒ½ä¼˜åŒ–
- Supabase Realtimeå¤§è§„æ¨¡è®¢é˜…ç®¡ç†
- å®Œæ•´ç³»ç»Ÿç›‘æ§å’Œå‘Šè­¦

---

## ğŸ”„ é«˜ä»·å€¼ç»„ä»¶Supabaseé€‚é…ç­–ç•¥

åŸºäºæ·±åº¦åˆ†æç»“æœï¼Œä»¥ä¸‹**11ä¸ªæ ¸å¿ƒç»„ä»¶**æŒ‰Supabaseé€‚é…ä¼˜å…ˆçº§åˆ†çº§ï¼š

### ä¸€çº§é€‚é…ç»„ä»¶ï¼ˆç›´æ¥Supabaseé›†æˆï¼‰- 2ä¸ª
**ç‰¹å¾**: è®¤è¯ç›¸å…³ç»„ä»¶ï¼Œéœ€è¦å®Œå…¨é‡å†™ä¸ºSupabase Auth

#### è®¤è¯å’Œæƒé™ç»„ä»¶
- **GuestModeGuard.tsx** â†’ é€‚é…Supabase AuthçŠ¶æ€æ£€æŸ¥ï¼Œä½¿ç”¨`supabase.auth.getSession()`
- **withAuth.tsx** â†’ å®Œå…¨é‡å†™ä¸ºSupabase Auth HOCï¼Œé›†æˆ`supabase.auth.onAuthStateChange()`

```typescript
// ğŸš¨ é€‚é…ç¤ºä¾‹ï¼šä»JWTè½¬æ¢ä¸ºSupabase Auth
// âŒ åŸæ–¹æ¡ˆ
const useAuth = () => {
  const token = localStorage.getItem('jwt');
  return { isAuthenticated: !!token };
};

// âœ… Supabase Authæ–¹æ¡ˆ
const useAuth = () => {
  const [session, setSession] = useState(null);
  
  useEffect(() => {
    supabase.auth.getSession().then(({ data: { session } }) => {
      setSession(session);
    });
    
    const { data: { subscription } } = supabase.auth.onAuthStateChange(
      (_event, session) => setSession(session)
    );
    
    return () => subscription.unsubscribe();
  }, []);
  
  return { session, isAuthenticated: !!session };
};
```

### äºŒçº§é€‚é…ç»„ä»¶ï¼ˆæ•°æ®æ¨¡å‹é€‚é…ï¼‰- 3ä¸ª
**ç‰¹å¾**: éœ€è¦é€‚é…åŒ¿ååŒ–æ•°æ®æ¨¡å‹å’ŒSupabase Clientè°ƒç”¨

- **PrescriptionCreator.tsx** â†’ ç§»é™¤æ‚£è€…ä¿¡æ¯å­—æ®µï¼Œé›†æˆSupabaseæ•°æ®æäº¤
- **PrescriptionDashboard.tsx** â†’ é€‚é…Supabaseå®æ—¶è®¢é˜…å’ŒRLSç­–ç•¥
- **LoginPromptModal.tsx** â†’ é›†æˆSupabase Authç™»å½•æµç¨‹

```typescript
// ğŸš¨ æ•°æ®æ¨¡å‹é€‚é…ç¤ºä¾‹
// âŒ åŸéšç§æ•°æ®æ¨¡å‹
interface OldPrescriptionModel {
  patientName: string;     // è¿åGDPR/HIPAA - å¿…é¡»ç§»é™¤
  patientAge?: number;     // è¿åéšç§åˆè§„ - å¿…é¡»ç§»é™¤
  patientPhone?: string;   // æ•æ„Ÿä¿¡æ¯ - å¿…é¡»ç§»é™¤
}

// âœ… æ–°åŒ¿ååŒ–æ•°æ®æ¨¡å‹
interface NewPrescriptionModel {
  id: string;
  prescriptionCode: string;    // ğŸ†• åŒ¿åå¤„æ–¹ç¼–å·
  practitionerId: string;      // ä»…ä¿ç•™åŒ»å¸ˆä¿¡æ¯
  status: 'DRAFT' | 'PAID' | 'FULFILLED' | 'COMPLETED';
  totalAmount: number;         // NZD centsç²¾åº¦
  medicines: PrescriptionMedicineModel[];
  // âŒ å®Œå…¨ç§»é™¤æ‰€æœ‰æ‚£è€…å­—æ®µ
}
```

### ä¸‰çº§é€‚é…ç»„ä»¶ï¼ˆAPIæ¶æ„è°ƒæ•´ï¼‰- 2ä¸ªæœåŠ¡
**ç‰¹å¾**: éœ€è¦ä»ä¼ ç»ŸAPIè°ƒç”¨æ”¹ä¸ºSupabase Client + RLSæ¨¡å¼

- **medicineService.ts** â†’ æ”¹ä¸ºSupabase Clientè°ƒç”¨ï¼Œé›†æˆRLSç­–ç•¥
- **prescriptionService.ts** â†’ é›†æˆSupabaseå®æ—¶è®¢é˜…å’Œæ•°æ®åº“ç›´è¿

```typescript
// ğŸš¨ APIæ¶æ„é€‚é…ç¤ºä¾‹
// âŒ åŸAPIå®¢æˆ·ç«¯æ¨¡å¼
const apiClient = axios.create({
  baseURL: process.env.NEXT_PUBLIC_API_URL,
  headers: { Authorization: `Bearer ${jwt}` }
});

// âœ… Supabaseç›´æ¥é›†æˆæ¨¡å¼
import { createClient } from '@supabase/supabase-js'

const supabase = createClient(
  process.env.NEXT_PUBLIC_SUPABASE_URL!,
  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!
)

// ğŸš¨ RLSç­–ç•¥è‡ªåŠ¨æƒé™æ§åˆ¶ï¼Œæ— éœ€æ‰‹åŠ¨æƒé™æ£€æŸ¥
const { data: prescriptions } = await supabase
  .from('prescriptions')
  .select('*') // åªè¿”å›ç”¨æˆ·æœ‰æƒé™çš„æ•°æ®
```

### å››çº§é€‚é…ç»„ä»¶ï¼ˆä¸šåŠ¡é€»è¾‘ä¿ç•™ï¼‰- 4ä¸ª
**ç‰¹å¾**: çº¯ä¸šåŠ¡é€»è¾‘ç»„ä»¶ï¼Œå¯ç›´æ¥å¤ç”¨

- **MedicineSearch.tsx** - è¯å“æœç´¢ç»„ä»¶ï¼ˆä¿ç•™æœç´¢ç®—æ³•ï¼‰
- **PrescriptionDetailModal.tsx** - å¤„æ–¹è¯¦æƒ…å±•ç¤ºï¼ˆé€‚é…æ–°æ•°æ®æ¨¡å‹ï¼‰
- **prescriptionCalculator.ts** - å¤„æ–¹è®¡ç®—é€»è¾‘ï¼ˆè¿ç§»åˆ°Edge Functionsï¼‰
- **qrParser.ts** - QRç è§£æå·¥å…·ï¼ˆç›´æ¥å¤ç”¨ï¼‰

### Supabaseé€‚é…ä»·å€¼è¯„ä¼°
- **é¢„è®¡èŠ‚çœå¼€å‘æ—¶é—´**: 40-60%ï¼ˆé™ä½ç”±äºæ¶æ„é‡æ„ï¼‰
- **é¢„è®¡æå‡å®‰å…¨æ€§**: 80%ï¼ˆRLSç­–ç•¥+ä¼ä¸šçº§è®¤è¯ï¼‰
- **é¢„è®¡é™ä½ç»´æŠ¤æˆæœ¬**: 70%ï¼ˆäº‘åŸç”ŸåŸºç¡€è®¾æ–½ï¼‰

---

## ğŸ—ï¸ Supabase-Firstæ ¸å¿ƒæŠ€æœ¯æ¶æ„è¦ç´ åº“

### Module 00.5: Supabaseé›†æˆåŸºç¡€æ¶æ„

#### Supabaseé¡¹ç›®é…ç½®

**æŠ€æœ¯é€‰å‹ä¾æ®**:
- **Supabase Auth**: ä¼ä¸šçº§è®¤è¯æœåŠ¡ï¼Œæ›¿ä»£è‡ªå®šä¹‰JWTï¼Œæ”¯æŒå¤šç§è®¤è¯æ–¹å¼
- **PostgreSQL + RLS**: æ•°æ®åº“å±‚æƒé™æ§åˆ¶ï¼Œæ›¿ä»£åº”ç”¨å±‚æƒé™æ£€æŸ¥
- **Edge Functions**: æœåŠ¡å™¨ç«¯ä¸šåŠ¡é€»è¾‘ï¼Œç¡®ä¿è®¡ç®—å®‰å…¨æ€§
- **Supabase CLI**: æœ¬åœ°å¼€å‘å·¥å…·ï¼Œæ”¯æŒç±»å‹ç”Ÿæˆå’Œæ•°æ®åº“è¿ç§»

**å…³é”®æ¶æ„å†³ç­–**:
- **Supabaseä¼˜å…ˆåŸåˆ™**: ä¼˜å…ˆä½¿ç”¨SupabaseåŸç”ŸåŠŸèƒ½ï¼Œé¿å…é‡å¤å¼€å‘
- **RLSç­–ç•¥è®¾è®¡**: åŒ»å¸ˆä»…èƒ½è®¿é—®è‡ªæœ‰æ•°æ®ï¼Œè¯æˆ¿ä»…å¤„ç†åˆ†é…è®¢å•
- **Edge Functionsè¾¹ç•Œ**: ä»…å¤„ç†å¤æ‚ä¸šåŠ¡é€»è¾‘ï¼Œé¿å…æ»¥ç”¨

**å®ç°è·¯å¾„æ¨è**:
1. åˆ›å»ºä¸‰ä¸ªSupabaseé¡¹ç›®ï¼ˆå¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ï¼‰
2. é…ç½®Supabase CLIå’Œæœ¬åœ°å¼€å‘ç¯å¢ƒ
3. è®¾è®¡å’Œå®ç°RLSç­–ç•¥
4. ç”ŸæˆTypeScriptç±»å‹å®šä¹‰

#### æ•°æ®åº“ç›´è¿æ¨¡å¼

**æ¶æ„è®¾è®¡é€»è¾‘**:
```typescript
// Supabaseæ•°æ®åº“ç›´è¿æ¶æ„
const dataFlow = {
  è®¤è¯: 'Supabase Authè‡ªåŠ¨å¤„ç†',
  æƒé™: 'RLSç­–ç•¥æ•°æ®åº“å±‚æ§åˆ¶',
  æŸ¥è¯¢: 'Supabase Clientç›´æ¥è®¿é—®',
  å®æ—¶: 'Supabase RealtimeåŸç”Ÿè®¢é˜…',
  æ–‡ä»¶: 'Supabase Storageäº‘å­˜å‚¨'
}
```

**å…³é”®å†³ç­–ç‚¹**:
- **æ›¿ä»£ä¼ ç»ŸAPIæ¨¡å¼**: ç›´æ¥æ•°æ®åº“è®¿é—®å‡å°‘ä¸­é—´å±‚
- **å®æ—¶è®¢é˜…æœºåˆ¶**: åŸºäºæ•°æ®åº“å˜æ›´çš„å®æ—¶æ¨é€
- **ç¦»çº¿æ•°æ®åŒæ­¥**: ç½‘ç»œæ¢å¤åçš„å¢é‡åŒæ­¥ç­–ç•¥

### Module 00: é¡¹ç›®åˆå§‹åŒ–æ¨¡å—

#### Supabase-Next.jsé¡¹ç›®è„šæ‰‹æ¶æ¶æ„

**æŠ€æœ¯é€‰å‹ä¾æ®**:
- **Next.js 14 + Supabase Starter Kit**: æˆç†Ÿçš„Supabaseé›†æˆè„šæ‰‹æ¶
- **TypeScript**: å¼ºç±»å‹ç³»ç»Ÿé…åˆSupabaseè‡ªåŠ¨ç”Ÿæˆç±»å‹
- **pnpm**: é…åˆSupabase CLIçš„åŒ…ç®¡ç†ä¼˜åŒ–

**å…³é”®æ¶æ„å†³ç­–**:
- **Supabaseé›†æˆä¼˜å…ˆ**: ä½¿ç”¨å®˜æ–¹Starter Kité¿å…é…ç½®å¤æ‚æ€§
- **ç±»å‹å®‰å…¨**: åŸºäºSupabase Schemaè‡ªåŠ¨ç”ŸæˆTypeScriptç±»å‹
- **ç¯å¢ƒé…ç½®**: ç»Ÿä¸€çš„Supabaseç¯å¢ƒå˜é‡ç®¡ç†

**å®ç°è·¯å¾„æ¨è**:
1. ä½¿ç”¨Supabase Next.jsæ¨¡æ¿åˆå§‹åŒ–é¡¹ç›®
2. é…ç½®Supabase CLIå’Œç¯å¢ƒå˜é‡
3. è®¾ç½®è‡ªåŠ¨ç±»å‹ç”Ÿæˆï¼š`supabase gen types typescript`
4. é…ç½®å¼€å‘ç¯å¢ƒçš„RLSç­–ç•¥æµ‹è¯•

**ğŸš¨ ç¯å¢ƒå˜é‡é…ç½®æ›´æ–°**:

```bash
# âŒ åºŸå¼ƒçš„ç¯å¢ƒå˜é‡
NEXT_PUBLIC_API_URL=http://localhost:3001        # åºŸå¼ƒ
JWT_SECRET=your-jwt-secret                       # åºŸå¼ƒ

# âœ… æ–°çš„Supabaseé…ç½®
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-supabase-anon-key
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_...
```

### Module 01: æ ¸å¿ƒåŸºç¡€è®¾æ–½æ¨¡å—

#### Supabaseé›†æˆè·¯ç”±ç³»ç»Ÿæ¶æ„è®¾è®¡

**æŠ€æœ¯é€‰å‹ä¾æ®**:
- **Next.js App Router + Supabase Auth**: ç»“åˆæ–‡ä»¶ç³»ç»Ÿè·¯ç”±å’Œè®¤è¯ä¸­é—´ä»¶
- **RLSç­–ç•¥è·¯ç”±ä¿æŠ¤**: æ•°æ®åº“å±‚é¢çš„è·¯ç”±æƒé™æ§åˆ¶
- **Supabaseè®¤è¯ä¸­é—´ä»¶**: è‡ªåŠ¨å¤„ç†è®¤è¯çŠ¶æ€å’Œè·¯ç”±ä¿æŠ¤

**æ¶æ„è®¾è®¡é€»è¾‘**:
```
Supabaseé›†æˆè·¯ç”±å±‚æ¬¡ç»“æ„:
app/
â”œâ”€â”€ (public)/                 # å…¬å¼€è®¿é—®è·¯ç”±ç»„
â”‚   â”œâ”€â”€ login/page.tsx        # Supabase Authç™»å½•é¡µé¢
â”‚   â””â”€â”€ register/page.tsx     # Supabase Authæ³¨å†Œé¡µé¢
â”œâ”€â”€ (protected)/              # éœ€è¦Supabaseè®¤è¯çš„è·¯ç”±ç»„
â”‚   â”œâ”€â”€ layout.tsx            # Supabaseè®¤è¯ä¸­é—´ä»¶
â”‚   â”œâ”€â”€ dashboard/page.tsx    # ä»ªè¡¨ç›˜ï¼ˆRLSç­–ç•¥ä¿æŠ¤ï¼‰
â”‚   â””â”€â”€ prescriptions/        # å¤„æ–¹ç®¡ç†ï¼ˆè‡ªåŠ¨æƒé™æ§åˆ¶ï¼‰
â””â”€â”€ (guest)/                  # Guestæ¨¡å¼è·¯ç”±ç»„
    â””â”€â”€ prescription/create/  # åŒ¿åå¤„æ–¹åˆ›å»º
```

**å…³é”®å†³ç­–ç‚¹**:
- **Supabaseè®¤è¯ä¸­é—´ä»¶**: åœ¨å¸ƒå±€å±‚é¢å®ç°è‡ªåŠ¨è®¤è¯æ£€æŸ¥
- **RLSç­–ç•¥é›†æˆ**: è·¯ç”±çº§åˆ«çš„æ•°æ®è®¿é—®æƒé™æ§åˆ¶
- **å®æ—¶çŠ¶æ€åŒæ­¥**: è®¤è¯çŠ¶æ€å˜æ›´çš„è‡ªåŠ¨è·¯ç”±é‡å®šå‘

#### SupabaseçŠ¶æ€ç®¡ç†æ¶æ„è®¾è®¡

**æŠ€æœ¯é€‰å‹ä¾æ®**:
- **Zustand + Supabase Realtime**: ç»“åˆæœ¬åœ°çŠ¶æ€å’Œæ•°æ®åº“å®æ—¶åŒæ­¥
- **Supabaseè®¤è¯çŠ¶æ€**: ä½¿ç”¨Supabase AuthåŸç”ŸçŠ¶æ€ç®¡ç†
- **RLSç­–ç•¥çŠ¶æ€**: åŸºäºæ•°æ®åº“æƒé™çš„çŠ¶æ€åˆ†å±‚

**æ¶æ„è®¾è®¡é€»è¾‘**:
```
Supabaseé›†æˆçŠ¶æ€ç®¡ç†å±‚æ¬¡:
â”œâ”€â”€ Supabase Auth State (åŸç”Ÿ)
â”‚   â”œâ”€â”€ session - è®¤è¯ä¼šè¯
â”‚   â”œâ”€â”€ user - ç”¨æˆ·ä¿¡æ¯
â”‚   â””â”€â”€ authState - è®¤è¯çŠ¶æ€
â”œâ”€â”€ Supabase Realtime State
â”‚   â”œâ”€â”€ prescriptions - å¤„æ–¹å®æ—¶æ•°æ®
â”‚   â”œâ”€â”€ accounts - è´¦æˆ·ä½™é¢å®æ—¶åŒæ­¥
â”‚   â””â”€â”€ orders - è®¢å•çŠ¶æ€å®æ—¶æ›´æ–°
â””â”€â”€ Local State (Zustand)
    â”œâ”€â”€ preferences - ç”¨æˆ·åå¥½
    â””â”€â”€ ui - ç•Œé¢çŠ¶æ€
```

**å…³é”®å†³ç­–ç‚¹**:
- **å®æ—¶æ•°æ®ä¼˜å…ˆ**: ä¼˜å…ˆä½¿ç”¨Supabase Realtimeè€Œéæœ¬åœ°çŠ¶æ€
- **è®¤è¯çŠ¶æ€é›†æˆ**: ç›´æ¥ä½¿ç”¨Supabase AuthçŠ¶æ€ï¼Œé¿å…é‡å¤ç®¡ç†
- **RLSç­–ç•¥ä¾èµ–**: çŠ¶æ€æ›´æ–°ä¾èµ–æ•°æ®åº“æƒé™ç­–ç•¥

### Module 03: Supabaseè®¤è¯ç³»ç»Ÿæ¨¡å—

#### Supabase Authé›†æˆæ¶æ„ (æ›¿ä»£JWTæ–¹æ¡ˆ)

**æŠ€æœ¯é€‰å‹ä¾æ®**:
- **Supabase Auth**: ä¼ä¸šçº§è®¤è¯æœåŠ¡ï¼Œæ›¿ä»£è‡ªå®šä¹‰JWT
- **GoTrueå¼•æ“**: æ”¯æŒå¤šç§è®¤è¯æ–¹å¼ï¼Œè‡ªåŠ¨ä¼šè¯ç®¡ç†
- **RLSç­–ç•¥**: æ•°æ®åº“å±‚æƒé™æ§åˆ¶ï¼Œæ›¿ä»£åº”ç”¨å±‚æƒé™æ£€æŸ¥
- **å®æ—¶ä¼šè¯**: è‡ªåŠ¨tokenåˆ·æ–°å’Œä¼šè¯çŠ¶æ€åŒæ­¥

**æ¶æ„è®¾è®¡é€»è¾‘**:
```typescript
// Supabase Authæ¶æ„
const authFlow = {
  ç™»å½•: 'supabase.auth.signInWithPassword()',
  æ³¨å†Œ: 'supabase.auth.signUp()',
  ä¼šè¯æ£€æŸ¥: 'supabase.auth.getSession()',
  æƒé™æ§åˆ¶: 'RLSç­–ç•¥è‡ªåŠ¨æ‰§è¡Œ',
  å®æ—¶çŠ¶æ€: 'supabase.auth.onAuthStateChange()'
}
```

**ğŸš¨ è®¤è¯ç³»ç»Ÿå®Œå…¨æ›¿æ¢**:

```typescript
// âŒ åŸJWTè®¤è¯æ¨¡å¼ - å®Œå…¨åºŸå¼ƒ
const authenticateUser = async (credentials) => {
  const response = await fetch('/api/auth/login', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(credentials)
  });
  const { token } = await response.json();
  localStorage.setItem('jwt', token);
};

// âœ… Supabase Authæ¨¡å¼ - å¼ºåˆ¶ä½¿ç”¨
const authenticateUser = async (credentials) => {
  const { data, error } = await supabase.auth.signInWithPassword({
    email: credentials.email,
    password: credentials.password
  });
  
  // æ— éœ€æ‰‹åŠ¨ç®¡ç†tokenï¼ŒSupabaseè‡ªåŠ¨å¤„ç†
  // RLSç­–ç•¥è‡ªåŠ¨ç”Ÿæ•ˆï¼Œæ— éœ€æ‰‹åŠ¨æƒé™æ£€æŸ¥
};
```

#### RLSç­–ç•¥æƒé™ä½“ç³»è®¾è®¡

**è®¾è®¡ç†å¿µ**:
- **æ•°æ®åº“å±‚æƒé™**: æƒé™æ§åˆ¶åœ¨æ•°æ®åº“å±‚æ‰§è¡Œï¼Œæ›´å®‰å…¨å¯é 
- **è§’è‰²è‡ªåŠ¨è¯†åˆ«**: åŸºäºauth.users.user_metadata.roleè‡ªåŠ¨æƒé™åˆ†é…
- **æ•°æ®éš”ç¦»**: åŒ»å¸ˆåªèƒ½è®¿é—®è‡ªæœ‰æ•°æ®ï¼Œè¯æˆ¿åªèƒ½å¤„ç†åˆ†é…è®¢å•

**RLSç­–ç•¥æ¶æ„**:
```sql
-- åŒ»å¸ˆæ•°æ®éš”ç¦»ç­–ç•¥
CREATE POLICY "doctors_own_data" ON prescriptions
FOR ALL USING (auth.uid() = doctor_id);

-- è¯æˆ¿æƒé™æ§åˆ¶ç­–ç•¥
CREATE POLICY "pharmacy_assigned_orders" ON purchase_orders
FOR ALL USING (
  pharmacy_id IN (
    SELECT id FROM pharmacies 
    WHERE operator_id = auth.uid()
  )
);

-- ç®¡ç†å‘˜å…¨å±€è®¿é—®ç­–ç•¥
CREATE POLICY "admin_full_access" ON ALL TABLES
FOR ALL USING (auth.jwt()->>'role' = 'admin');
```

#### Guestæ¨¡å¼Supabaseé›†æˆæ¶æ„

**è®¾è®¡ç†å¿µ**:
- **åŒ¿åä¼šè¯**: ä½¿ç”¨SupabaseåŒ¿åè®¤è¯æ”¯æŒGuestæ¨¡å¼
- **æ•°æ®éš”ç¦»**: Guestæ•°æ®ä¸è®¤è¯ç”¨æˆ·æ•°æ®å®Œå…¨åˆ†ç¦»
- **æ— ç¼è½¬æ¢**: Gueståˆ°è®¤è¯ç”¨æˆ·çš„æ•°æ®è¿ç§»æœºåˆ¶

**å®ç°è·¯å¾„**:
```typescript
// Guestæ¨¡å¼Supabaseé›†æˆ
const guestMode = {
  åˆ›å»ºåŒ¿åä¼šè¯: 'supabase.auth.signInAnonymously()',
  æ•°æ®éš”ç¦»: 'guest_prescriptionsè¡¨åˆ†ç¦»å­˜å‚¨',
  è½¬æ¢æœºåˆ¶: 'æ³¨å†Œæ—¶è¿ç§»Guestæ•°æ®åˆ°ç”¨æˆ·è¡¨',
  æƒé™æ§åˆ¶: 'RLSç­–ç•¥é™åˆ¶GueståŠŸèƒ½èŒƒå›´'
}
```

### Module 04: å¤„æ–¹æ ¸å¿ƒæ¨¡å—

#### åŒ¿ååŒ–å¤„æ–¹åˆ›å»ºæµç¨‹æ¶æ„ (éšç§åˆè§„ç‰ˆ)

**ğŸš¨ éšç§åˆè§„ä¸šåŠ¡æµç¨‹è®¾è®¡**:
```
åŒ¿ååŒ–å¤„æ–¹åˆ›å»ºæµç¨‹:
Step 1: åŒ¿åå¤„æ–¹åŸºç¡€ä¿¡æ¯
â”œâ”€â”€ ç”Ÿæˆå¤„æ–¹ç¼–å·ï¼ˆprescriptionCodeï¼‰
â”œâ”€â”€ åŒ»å¸ˆä¿¡æ¯å½•å…¥ï¼ˆpractitionerIdï¼‰
â”œâ”€â”€ âŒ å®Œå…¨ç§»é™¤æ‚£è€…éšç§ä¿¡æ¯å½•å…¥
â””â”€â”€ åŒ¿ååŒ–ä¿¡æ¯æ ¼å¼æ ‡å‡†åŒ–

Step 2: è¯å“é€‰æ‹©ä¸é…ç½®
â”œâ”€â”€ æ™ºèƒ½è¯å“æœç´¢ï¼ˆSupabase medicinesè¡¨basePriceï¼‰
â”œâ”€â”€ ç”¨é‡è®¡ç®—ä¸éªŒè¯
â””â”€â”€ è¯ç‰©ç›¸äº’ä½œç”¨æ£€æŸ¥ï¼ˆEdge Functionsï¼‰

Step 3: å¤„æ–¹ç¡®è®¤ä¸é¢„è§ˆ
â”œâ”€â”€ æ€»ä»·è®¡ç®—ï¼ˆbasePrice * æ•°é‡ï¼ŒEdge Functionsæ‰§è¡Œï¼‰
â”œâ”€â”€ åŒ¿åå¤„æ–¹æ ¼å¼é¢„è§ˆ
â””â”€â”€ GDPR/HIPAAåˆè§„æ€§æ£€æŸ¥

Step 4: æ”¯ä»˜ä¸çŠ¶æ€æµè½¬
â”œâ”€â”€ Stripeæ”¯ä»˜å¤„ç†æˆ–è´¦æˆ·æ‰£è´¹ï¼ˆEdge Functionsï¼‰
â”œâ”€â”€ æ”¯ä»˜æˆåŠŸåçŠ¶æ€å˜æ›´(DRAFT â†’ PAID)
â”œâ”€â”€ QRç ç”Ÿæˆå’ŒåŒ¿åå¤„æ–¹æ¿€æ´»
â””â”€â”€ PDFå¯¼å‡ºå’Œæ‰“å°æ”¯æŒï¼ˆæ— æ‚£è€…ä¿¡æ¯ï¼‰
```

#### Supabase Edge Functionsæ”¯ä»˜é›†æˆæ¶æ„

**æŠ€æœ¯é€‰å‹ä¾æ®**:
- **Edge Functions + Stripe**: æœåŠ¡å™¨ç«¯æ”¯ä»˜å¤„ç†ï¼Œç¡®ä¿å®‰å…¨æ€§
- **åŒæ”¯ä»˜æ¨¡å¼**: Stripeä¿¡ç”¨å¡æ”¯ä»˜å’Œè´¦æˆ·ä½™é¢æ‰£è´¹
- **å®æ—¶çŠ¶æ€åŒæ­¥**: æ”¯ä»˜æˆåŠŸåSupabase Realtimeè‡ªåŠ¨æ›´æ–°

**æ”¯ä»˜æµç¨‹è®¾è®¡**:
```typescript
// Edge Functionsæ”¯ä»˜å¤„ç†æµç¨‹
const paymentFlow = {
  å‰ç«¯: 'æ”¶é›†æ”¯ä»˜ä¿¡æ¯ï¼ˆä¸ç»è¿‡æœåŠ¡å™¨ï¼‰',
  EdgeFunction: 'processPaymentå‡½æ•°å¤„ç†æ”¯ä»˜é€»è¾‘',
  Stripe: 'å®‰å…¨æ”¯ä»˜å¤„ç†å’ŒéªŒè¯',
  æ•°æ®åº“: 'æ”¯ä»˜æˆåŠŸåæ›´æ–°å¤„æ–¹çŠ¶æ€',
  å®æ—¶åŒæ­¥: 'Supabase Realtimeæ¨é€çŠ¶æ€å˜æ›´'
}
```

**å…³é”®é›†æˆè¦ç‚¹**:
- **Edge Functionså®‰å…¨**: æ‰€æœ‰ä»·æ ¼è®¡ç®—åœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œï¼Œé˜²æ­¢å‰ç«¯æ“æ§
- **RLSç­–ç•¥ä¿æŠ¤**: æ”¯ä»˜ç›¸å…³æ•°æ®å—RLSç­–ç•¥ä¿æŠ¤
- **å®æ—¶çŠ¶æ€**: æ”¯ä»˜çŠ¶æ€é€šè¿‡Supabase Realtimeå®æ—¶æ¨é€

### Module 05: Supabaseæ•°æ®ç®¡ç†æ¨¡å—

#### Supabase Clientæ¶æ„è®¾è®¡

**æŠ€æœ¯é€‰å‹ä¾æ®**:
- **Supabase Client SDK**: æ›¿ä»£ä¼ ç»ŸHTTPå®¢æˆ·ç«¯ï¼Œç›´æ¥æ•°æ®åº“è®¿é—®
- **è‡ªåŠ¨ç±»å‹ç”Ÿæˆ**: `supabase gen types typescript`ç¡®ä¿ç±»å‹å®‰å…¨
- **RLSç­–ç•¥é›†æˆ**: æŸ¥è¯¢è‡ªåŠ¨åº”ç”¨æƒé™æ§åˆ¶

**æ¶æ„è®¾è®¡é€»è¾‘**:
```typescript
// Supabase Clientæ•°æ®è®¿é—®æ¶æ„
const dataAccess = {
  æŸ¥è¯¢: 'supabase.from(table).select()',
  æ’å…¥: 'supabase.from(table).insert()',
  æ›´æ–°: 'supabase.from(table).update()',
  åˆ é™¤: 'supabase.from(table).delete()',
  å®æ—¶: 'supabase.from(table).on().subscribe()',
  æƒé™: 'RLSç­–ç•¥è‡ªåŠ¨åº”ç”¨'
}
```

**ğŸš¨ APIé›†æˆç­–ç•¥å®Œå…¨æ›¿æ¢**:

```typescript
// âŒ åŸAPIå®¢æˆ·ç«¯æ¨¡å¼ - å®Œå…¨åºŸå¼ƒ
const fetchPrescriptions = async () => {
  const response = await fetch('/api/prescriptions', {
    headers: { Authorization: `Bearer ${jwt}` }
  });
  return response.json();
};

// âœ… Supabaseç›´æ¥è®¿é—®æ¨¡å¼ - å¼ºåˆ¶ä½¿ç”¨
const fetchPrescriptions = async () => {
  const { data, error } = await supabase
    .from('prescriptions')
    .select(`
      *,
      prescription_medicines (
        *,
        medicines (*)
      )
    `);
  
  // RLSç­–ç•¥è‡ªåŠ¨è¿‡æ»¤ï¼Œåªè¿”å›ç”¨æˆ·æœ‰æƒé™çš„æ•°æ®
  return data;
};
```

#### Supabase Storageæ–‡ä»¶ç®¡ç†æ¶æ„

**æŠ€æœ¯é€‰å‹ä¾æ®**:
- **Supabase Storage**: æ›¿ä»£æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼Œäº‘åŸç”Ÿå­˜å‚¨
- **è‡ªåŠ¨CDN**: å…¨çƒCDNåŠ é€Ÿï¼Œæå‡æ–‡ä»¶è®¿é—®æ€§èƒ½
- **RLSç­–ç•¥ä¿æŠ¤**: æ–‡ä»¶è®¿é—®æƒé™ä¸æ•°æ®æƒé™ç»Ÿä¸€ç®¡ç†

**å­˜å‚¨æ¶æ„è®¾è®¡**:
```typescript
// Supabase Storageæ¶æ„
const storageFlow = {
  ä¸Šä¼ : 'supabase.storage.from(bucket).upload()',
  ä¸‹è½½: 'supabase.storage.from(bucket).download()',
  æƒé™: 'RLSç­–ç•¥æ§åˆ¶æ–‡ä»¶è®¿é—®',
  CDN: 'è‡ªåŠ¨å…¨çƒCDNåˆ†å‘',
  ç›‘æ§: 'Supabase Dashboardæ–‡ä»¶ç›‘æ§'
}
```

### Module 06: è´¨é‡ä¿è¯æ¨¡å—

#### Supabaseé›†æˆæµ‹è¯•ç­–ç•¥æ¶æ„

**æµ‹è¯•é‡‘å­—å¡”å®ç°**:
```
Supabaseé›†æˆæµ‹è¯•æ¶æ„å±‚æ¬¡:
â”œâ”€â”€ Unit Tests (60%) - Jest + Testing Library
â”‚   â”œâ”€â”€ Supabase Clientè°ƒç”¨æµ‹è¯•
â”‚   â”œâ”€â”€ RLSç­–ç•¥å•å…ƒæµ‹è¯•
â”‚   â””â”€â”€ Edge Functionså•å…ƒæµ‹è¯•
â”œâ”€â”€ Integration Tests (30%) - Supabase Test Database
â”‚   â”œâ”€â”€ Supabase Authé›†æˆæµ‹è¯•
â”‚   â”œâ”€â”€ RLSç­–ç•¥é›†æˆæµ‹è¯•
â”‚   â””â”€â”€ Realtimeè®¢é˜…é›†æˆæµ‹è¯•
â””â”€â”€ E2E Tests (10%) - Playwright + Supabase
    â”œâ”€â”€ å®Œæ•´Supabaseæµç¨‹æµ‹è¯•
    â”œâ”€â”€ è·¨è§’è‰²æƒé™æµ‹è¯•
    â””â”€â”€ å®æ—¶æ•°æ®åŒæ­¥æµ‹è¯•
```

**è´¨é‡é—¨ç¦è®¾ç½®**:
- **RLSç­–ç•¥è¦†ç›–ç‡**: 100%ï¼Œç¡®ä¿æ‰€æœ‰æ•°æ®è®¿é—®å—ç­–ç•¥ä¿æŠ¤
- **Edge Functionsæµ‹è¯•**: æ ¸å¿ƒä¸šåŠ¡é€»è¾‘>90%è¦†ç›–ç‡
- **è®¤è¯æµ‹è¯•**: Supabase Authæ‰€æœ‰è§’è‰²å’ŒçŠ¶æ€æµ‹è¯•

### Module 99: Supabaseç”Ÿäº§éƒ¨ç½²æ¨¡å—

#### Vercel + Supabaseé›†æˆéƒ¨ç½²æ¶æ„

**æ ¸å¿ƒæŠ€æœ¯æ ˆå¯¹é½**:
- **Frontend**: Vercel Next.js 14 + Supabase Starter Kit
- **Database + Auth**: Supabase PostgreSQL + GoTrueè®¤è¯
- **Real-time**: Supabase Realtimeè®¢é˜…
- **Storage**: Supabase Storageäº‘å­˜å‚¨
- **Backend**: Supabase Edge Functionsï¼ˆä»…å¤æ‚ä¸šåŠ¡é€»è¾‘ï¼‰
- **Payment**: Stripe APIé›†æˆ

#### Vercelé›†æˆé…ç½®

**vercel.jsoné…ç½®**:
```json
{
  "framework": "nextjs",
  "buildCommand": "npm run build",
  "outputDirectory": ".next",
  "regions": ["hkg1", "sin1"],
  "env": {
    "NEXT_PUBLIC_SUPABASE_URL": "@supabase-url",
    "NEXT_PUBLIC_SUPABASE_ANON_KEY": "@supabase-anon-key",
    "NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY": "@stripe-pk"
  },
  "integrations": {
    "supabase": {
      "projectId": "@supabase-project-id"
    }
  }
}
```

#### Supabaseç”Ÿäº§ç¯å¢ƒé…ç½®

**ç¯å¢ƒè§„åˆ’**:
- **å¼€å‘ç¯å¢ƒ**: Supabaseå¼€å‘é¡¹ç›® + Vercelé¢„è§ˆéƒ¨ç½²
- **æµ‹è¯•ç¯å¢ƒ**: Supabaseæµ‹è¯•é¡¹ç›® + Vercelæµ‹è¯•ç¯å¢ƒ
- **ç”Ÿäº§ç¯å¢ƒ**: Supabaseç”Ÿäº§é¡¹ç›® + Vercelç”Ÿäº§éƒ¨ç½²

**ç›‘æ§é…ç½®**:
- **Supabase Dashboard**: æ•°æ®åº“æ€§èƒ½ç›‘æ§
- **Edge Functionsç›‘æ§**: å‡½æ•°æ‰§è¡Œå’Œé”™è¯¯ç›‘æ§
- **RLSç­–ç•¥ç›‘æ§**: æƒé™è®¿é—®å’Œå®‰å…¨å®¡è®¡
- **Realtimeç›‘æ§**: å®æ—¶è®¢é˜…è¿æ¥å’Œæ€§èƒ½

---

## ğŸ“Š Supabase-Firståˆ†é˜¶æ®µå®æ–½è·¯çº¿å›¾

### ç¬¬ä¸€é˜¶æ®µ: SupabaseåŸºç¡€æ¶æ„æ­å»º (Week 1-2)

**å…³é”®é‡Œç¨‹ç¢‘**:
- Supabaseé¡¹ç›®åˆ›å»ºï¼ˆå¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒï¼‰
- Supabase CLIé…ç½®å’Œæœ¬åœ°å¼€å‘ç¯å¢ƒ
- ğŸš¨ å®Œå…¨ç§»é™¤è‡ªå®šä¹‰JWTè®¤è¯ä»£ç 
- Supabase AuthåŸºç¡€é›†æˆ
- RLSç­–ç•¥ç†è§£å’Œæµ‹è¯•ç¯å¢ƒé…ç½®

**éªŒæ”¶æ ‡å‡†**:
- âœ… ä¸‰ä¸ªSupabaseç¯å¢ƒå¯æ­£å¸¸è¿æ¥
- âœ… Supabase Authç™»å½•æ³¨å†Œæµç¨‹å¯ç”¨
- âœ… RLSç­–ç•¥åŸºç¡€é…ç½®ç”Ÿæ•ˆ
- âœ… TypeScriptç±»å‹è‡ªåŠ¨ç”Ÿæˆ
- âœ… âŒ æ‰€æœ‰è‡ªå®šä¹‰JWTä»£ç å·²ç§»é™¤

### ç¬¬äºŒé˜¶æ®µ: æ•°æ®æ¨¡å‹å’ŒRLSç­–ç•¥å®ç° (Week 3-4)

**å…³é”®é‡Œç¨‹ç¢‘**:
- ğŸš¨ éšç§åˆè§„æ•°æ®æ¨¡å‹å®ç°ï¼ˆå®Œå…¨åŒ¿ååŒ–ï¼‰
- 10å¼ æ ¸å¿ƒä¸šåŠ¡è¡¨RLSç­–ç•¥å®ç°
- Supabase Realtimeå®æ—¶è®¢é˜…é…ç½®
- åŒ¿åå¤„æ–¹åˆ›å»ºæµç¨‹å®ç°
- Edge FunctionsåŸºç¡€é…ç½®

**éªŒæ”¶æ ‡å‡†**:
- âœ… æ•°æ®æ¨¡å‹å®Œå…¨åŒ¿ååŒ–ï¼Œæ— æ‚£è€…éšç§ä¿¡æ¯
- âœ… RLSç­–ç•¥100%è¦†ç›–æ‰€æœ‰è¡¨
- âœ… å®æ—¶æ•°æ®è®¢é˜…æ­£å¸¸å·¥ä½œ
- âœ… åŒ¿åå¤„æ–¹æµç¨‹å®Œæ•´å¯ç”¨
- âœ… Edge Functionså¯æ­£å¸¸è°ƒç”¨

### ç¬¬ä¸‰é˜¶æ®µ: Edge Functionså’ŒStripeé›†æˆ (Week 5)

**å…³é”®é‡Œç¨‹ç¢‘**:
- ä»·æ ¼è®¡ç®—è¿ç§»åˆ°Edge Functions
- Stripeæ”¯ä»˜Edge Functionsé›†æˆ
- Supabase Storageæ–‡ä»¶ä¸Šä¼ 
- æœåŠ¡å™¨ç«¯ä¸šåŠ¡é€»è¾‘å®Œæ•´æ€§
- RLSç­–ç•¥æ€§èƒ½ä¼˜åŒ–

**éªŒæ”¶æ ‡å‡†**:
- âœ… æ‰€æœ‰ä»·æ ¼è®¡ç®—åœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œ
- âœ… Stripeæ”¯ä»˜æµç¨‹å®Œæ•´é›†æˆ
- âœ… Supabase Storageæ–‡ä»¶ç®¡ç†å¯ç”¨
- âœ… Edge Functionsæ€§èƒ½è¾¾æ ‡
- âœ… RLSç­–ç•¥æŸ¥è¯¢ä¼˜åŒ–å®Œæˆ

### ç¬¬å››é˜¶æ®µ: Vercelç”Ÿäº§éƒ¨ç½²å’Œç›‘æ§ (Week 6-7)

**å…³é”®é‡Œç¨‹ç¢‘**:
- Vercel + Supabaseç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
- Supabaseç”Ÿäº§ç¯å¢ƒé…ç½®å’ŒåŸŸåè®¾ç½®
- å®Œæ•´ç³»ç»Ÿæ€§èƒ½æµ‹è¯•
- Supabaseç›‘æ§å’Œå‘Šè­¦é…ç½®
- ç«¯åˆ°ç«¯å®‰å…¨æµ‹è¯•

**éªŒæ”¶æ ‡å‡†**:
- âœ… ç”Ÿäº§ç¯å¢ƒæˆåŠŸéƒ¨ç½²è¿è¡Œ
- âœ… Supabaseç›‘æ§å‘Šè­¦æ­£å¸¸
- âœ… æ€§èƒ½æŒ‡æ ‡è¾¾åˆ°ç”Ÿäº§æ ‡å‡†
- âœ… å®‰å…¨æµ‹è¯•å…¨éƒ¨é€šè¿‡
- âœ… éšç§åˆè§„éªŒè¯å®Œæˆ

---

## ğŸ¯ Supabase-Firstå…³é”®æˆåŠŸå› ç´ ä¸é£é™©æ§åˆ¶

### æŠ€æœ¯å±‚é¢æˆåŠŸå› ç´ 
- **Supabaseç”Ÿæ€æ·±åº¦é›†æˆ**: å……åˆ†åˆ©ç”¨SupabaseåŸç”ŸåŠŸèƒ½ï¼Œé¿å…é‡å¤å¼€å‘
- **RLSç­–ç•¥å®‰å…¨ä¼˜å…ˆ**: æ•°æ®åº“å±‚æƒé™æ§åˆ¶ç¡®ä¿å®‰å…¨æ€§
- **Edge Functionsæ€§èƒ½**: æœåŠ¡å™¨ç«¯è®¡ç®—ä¿è¯ä¸šåŠ¡é€»è¾‘å®‰å…¨æ€§

### ç®¡ç†å±‚é¢æˆåŠŸå› ç´ 
- **éšç§åˆè§„å¼ºåˆ¶**: ä¸¥æ ¼æ‰§è¡ŒGDPR/HIPAAåˆè§„è¦æ±‚
- **æ¶æ„å†³ç­–ä¸å¯é€†**: Supabase-Firstå†³ç­–å·²ç¡®å®šï¼Œä¸å¾—å›é€€
- **å›¢é˜ŸæŠ€èƒ½å‡çº§**: å›¢é˜Ÿéœ€è¦æŒæ¡Supabaseç”Ÿæ€æŠ€æœ¯æ ˆ

### Supabaseé£é™©é˜²æ§çŸ©é˜µ

**é«˜é£é™©é¡¹ç›®**:
- ğŸ”´ **RLSç­–ç•¥å¤æ‚æ€§**: ç¼“è§£ç­–ç•¥æ˜¯å»ºç«‹å®Œå–„çš„æµ‹è¯•è¦†ç›–å’Œæƒé™éªŒè¯æœºåˆ¶
- ğŸ”´ **Edge Functionsæ€§èƒ½**: ç¼“è§£ç­–ç•¥æ˜¯æ€§èƒ½ç›‘æ§å’Œå‡½æ•°ä¼˜åŒ–
- ğŸ”´ **æ•°æ®è¿ç§»å¤æ‚æ€§**: ç¼“è§£ç­–ç•¥æ˜¯åˆ†æ­¥è¿ç§»å’Œæ•°æ®éªŒè¯

**ä¸­é£é™©é¡¹ç›®**:
- ğŸŸ¡ **Supabaseå­¦ä¹ æ›²çº¿**: ç¼“è§£ç­–ç•¥æ˜¯å›¢é˜ŸåŸ¹è®­å’Œæ–‡æ¡£å»ºè®¾
- ğŸŸ¡ **å®æ—¶è®¢é˜…ç®¡ç†**: ç¼“è§£ç­–ç•¥æ˜¯è®¢é˜…ä¼˜åŒ–å’Œè¿æ¥æ± ç®¡ç†
- ğŸŸ¡ **ç”Ÿäº§ç¯å¢ƒç¨³å®šæ€§**: ç¼“è§£ç­–ç•¥æ˜¯å¤šç¯å¢ƒæµ‹è¯•å’Œç›‘æ§å‘Šè­¦

**ä½é£é™©é¡¹ç›®**:
- ğŸŸ¢ **Vercelé›†æˆ**: Supabaseå®˜æ–¹æ”¯æŒVercelé›†æˆ
- ğŸŸ¢ **ç±»å‹å®‰å…¨**: è‡ªåŠ¨ç±»å‹ç”Ÿæˆç¡®ä¿å¼€å‘å®‰å…¨æ€§
- ğŸŸ¢ **ç›‘æ§ä½“ç³»**: Supabaseå†…ç½®ç›‘æ§å’Œåˆ†æåŠŸèƒ½

---

## âœ… Supabase-Firstæœ€ç»ˆå¤ç°æˆåŠŸæ ‡å‡†

### åŠŸèƒ½å®Œæ•´æ€§éªŒæ”¶
- âœ… **Supabase Authå®Œæ•´ä½“éªŒ**: ç”¨æˆ·è®¤è¯å®Œå…¨åŸºäºSupabaseï¼Œå®‰å…¨å¯é 
- âœ… **RLSç­–ç•¥æƒé™ä½“ç³»**: ä¸åŒè§’è‰²ç”¨æˆ·æ•°æ®è®¿é—®å—æ•°æ®åº“å±‚ç­–ç•¥ä¿æŠ¤
- âœ… **åŒ¿ååŒ–å¤„æ–¹ç®¡ç†**: å®Œå…¨åˆè§„çš„åŒ¿åå¤„æ–¹åˆ›å»ºã€ç®¡ç†ã€å¯¼å‡ºåŠŸèƒ½
- âœ… **å®æ—¶æ•°æ®åŒæ­¥**: Supabase Realtimeå®æ—¶æ•°æ®æ›´æ–°å‡†ç¡®åŠæ—¶
- âœ… **Edge Functionsä¸šåŠ¡**: æœåŠ¡å™¨ç«¯ä¸šåŠ¡é€»è¾‘å®‰å…¨å¯é 

### æŠ€æœ¯è´¨é‡éªŒæ”¶
- âœ… **Supabaseé›†æˆåº¦**: 100%ä½¿ç”¨SupabaseåŸç”ŸåŠŸèƒ½ï¼Œæ— è‡ªå®šä¹‰è®¤è¯ä»£ç 
- âœ… **RLSç­–ç•¥è¦†ç›–**: 100%æ•°æ®è®¿é—®å—ç­–ç•¥ä¿æŠ¤ï¼Œæƒé™æµ‹è¯•é€šè¿‡
- âœ… **éšç§åˆè§„**: å®Œå…¨åŒ¿ååŒ–æ•°æ®æ¨¡å‹ï¼ŒGDPR/HIPAAåˆè§„éªŒè¯é€šè¿‡
- âœ… **ç±»å‹å®‰å…¨**: åŸºäºSupabase Schemaè‡ªåŠ¨ç”Ÿæˆç±»å‹ï¼Œç±»å‹è¦†ç›–>95%
- âœ… **æ€§èƒ½æŒ‡æ ‡**: Edge Functionså“åº”<500msï¼ŒRLSæŸ¥è¯¢<100ms

### ä¸šåŠ¡ä»·å€¼éªŒæ”¶
- âœ… **å®‰å…¨æ€§æå‡**: æ•°æ®åº“å±‚æƒé™æ§åˆ¶ï¼Œå®‰å…¨æ€§æ¯”è‡ªå®šä¹‰è®¤è¯æå‡80%
- âœ… **åˆè§„æ€§ä¿è¯**: å®Œå…¨åŒ¿ååŒ–è®¾è®¡ï¼Œæ»¡è¶³åŒ»ç–—è¡Œä¸šéšç§åˆè§„è¦æ±‚
- âœ… **å¯ç»´æŠ¤æ€§**: äº‘åŸç”Ÿæ¶æ„ï¼Œç»´æŠ¤æˆæœ¬é™ä½70%
- âœ… **å¯æ‰©å±•æ€§**: Supabaseç”Ÿæ€æ”¯æŒï¼Œå…·å¤‡è‰¯å¥½çš„åŠŸèƒ½æ‰©å±•èƒ½åŠ›

---

## ğŸš¨ é‡è¦æé†’

### 1. æ¶æ„å˜æ›´ä¸å¯é€†
- Supabase-Firstå†³ç­–å·²ç¡®å®šï¼Œä¸å¾—å›é€€åˆ°åŸJWTæ–¹æ¡ˆ
- æ‰€æœ‰ç»„ä»¶å¿…é¡»é€‚é…æ–°æ¶æ„ï¼Œæ—§ç‰ˆæœ¬å°†ä¸è¢«æ”¯æŒ
- å‰ç«¯å¼€å‘å¿…é¡»åŸºäºSupabaseç”Ÿæ€ï¼Œä¸å¾—ä½¿ç”¨ä¼ ç»ŸAPIæ¨¡å¼

### 2. éšç§åˆè§„å¼ºåˆ¶è¦æ±‚
- ä»»ä½•åŒ…å«æ‚£è€…éšç§ä¿¡æ¯çš„ä»£ç éƒ½ä¸å¾—å¤ç”¨
- æ•°æ®æ¨¡å‹å¿…é¡»å®Œå…¨åŒ¿ååŒ–ï¼Œè¿åè€…æ‰¿æ‹…æ³•å¾‹è´£ä»»
- GDPR/HIPAAåˆè§„æ£€æŸ¥å°†ä½œä¸ºä»£ç å®¡æŸ¥å¼ºåˆ¶é¡¹

### 3. æŠ€æœ¯æ ˆç»Ÿä¸€è¦æ±‚
- å‰ç«¯å¿…é¡»ä½¿ç”¨Supabase Client SDKï¼Œä¸å¾—ä½¿ç”¨ä¼ ç»ŸHTTPå®¢æˆ·ç«¯
- è®¤è¯å¿…é¡»åŸºäºSupabase Authï¼Œä¸å¾—ä½¿ç”¨è‡ªå®šä¹‰JWT
- å®æ—¶åŠŸèƒ½å¿…é¡»ä½¿ç”¨Supabase Realtimeï¼Œä¸å¾—ä½¿ç”¨WebSocket

---

**ğŸ“‹ æœ€ç»ˆæé†’**: æœ¬Supabase-First PRDæŠ€æœ¯è¦ç´ æ–‡æ¡£æä¾›çš„æ˜¯äº‘åŸç”Ÿæ¶æ„è®¾è®¡å±‚é¢çš„æŒ‡å¯¼å’ŒSupabaseé›†æˆæ–¹æ¡ˆï¼Œå…·ä½“å®ç°ç»†èŠ‚éœ€è¦æ–°é¡¹ç›®ç»„ç»“åˆSupabaseæ–‡æ¡£è¿›è¡Œæ·±å…¥ç ”ç©¶å’Œæ¨å¯¼ã€‚æ‰€æœ‰æ•°æ®æ¨¡å‹ã€RLSç­–ç•¥ã€Edge Functionsç­‰ä»¥åç«¯SupabaseæŠ€æœ¯è½¬ç§»æ–‡æ¡£ä¸ºå‡†ï¼Œå‰ç«¯éœ€è¦ä¿æŒä¸Supabaseç”Ÿæ€çš„é«˜åº¦é›†æˆã€‚